---
title: "Homework 3"
author: "Henry Stoddard"
date: "10/10/2020"
output: github_document
---
## Problem 0
Creating initial markdown file and rendering to github doc

## Problem 1
```{r}
library(tidyverse)
library(p8105.datasets)
data("instacart")
```

This dataset contains `r nrow(instacart)` rows and `r ncol(instacart)` columns.
Observations are the level of items in orders by user. There are user / order variables -- user ID, order ID, order day, and order hour. There are also item variables - name, aisle, department, and some numeric codes.

How many aisles and which are most items from?

```{r}
aisles_df = instacart %>% 
  count(aisle) %>% 
  arrange(desc(n))
```
There are `r nrow(aisles_df)` aisles. The most items are ordered from fresh vegetables and fresh fruits.

Making a plot that shows number of items ordered in each aisle for aisles with more than 10,000 items ordered!
```{r}
instacart %>% 
  count(aisle) %>% 
  filter(n > 10000) %>% 
  mutate(
    aisle = factor(aisle),
    aisle = fct_reorder(aisle, n)
  ) %>% 
  ggplot(aes(x = aisle, y = n)) +
  geom_point() +
    theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))
```

Let's make a table!!
This table shows the three most popular items in the baking ingredients, dog food care, and packaged vegetables/fruits aisles, as well as how many times each item was ordered.
```{r}
instacart %>% 
  filter(aisle %in% c("baking ingredients", "dog food care", "packaged vegetables fruits")) %>% 
  group_by(aisle) %>% 
  count(product_name) %>% 
  mutate(rank = min_rank(desc(n))) %>% 
  filter(rank < 4) %>% 
  arrange(aisle, rank) %>% 
  knitr::kable()
```

Apples vs. Ice cream table
This table shows the mean hour of the day at which pink lady apples and coffee ice cream were ordered by day of the week.
```{r}
instacart %>%
  filter(product_name %in% c("Pink Lady Apples", "Coffee Ice Cream")) %>%
  group_by(product_name, order_dow) %>%
  summarise(mean_hour = mean(order_hour_of_day)) %>% 
  pivot_wider(
    names_from = order_dow,
    values_from = mean_hour
  )
```

## Problem 2

Loading and tidying data

```{r}
accel_df = read.csv("./data/accel_data.csv") %>% 
  janitor::clean_names() %>% 
  pivot_longer(activity_1:activity_1440, names_to = "minute",
               names_prefix = "activity_", values_to = "activity_count") %>% 
  mutate(day = factor(day),
         minute = as.numeric(minute),
         weekday_weekend = recode(day, "Monday" = "weekday",
                                  "Tuesday" = "weekday",
                                  "Wednesday" = "weekday",
                                  "Thursday" = "weekday",
                                  "Friday" = "weekday",
                                  "Saturday" = "weekend",
                                  "Sunday" = "weekend"))
```
This data set is `r nrow(accel_df)` rows long and `r ncol(accel_df)` columns wide. It contains variables on week, day of the week, minute of the day, activity count by minute, and whether the observation is from a weekday or weekend. Day is a factor variable and minute is a numeric variable.

```{r q2 p2}
accel_df2 = accel_df %>% 
  group_by(day, day_id) %>%
  summarise(total_activity = sum(activity_count))%>% ungroup(day, day_id) %>% 
              mutate(rank = min_rank(desc(total_activity))) %>% 
  arrange(rank) %>% knitr::kable()
```


gonna be more group_by and summary for pt 2. for day of week as column it may start as alphabetical order, so use factor to order correctly

part3: get minute on x axis and activity count on y axis, then add in scatterplot and geom_line, use color for day of the week. conclusions will probably show stuff about how we sleep at night, active in day, maybe differences by weekday vs weekend

## Problem 3

gonna use count and rank for third sentence of part 1.
part 2 organize data using group_by station, year, month, and summarize by month(?), also gonna need to filter. use facet to make 2 panel plot. trends could look like global warming!

part 3 make 2 plots separate and then use patchwork to pull them together. first one should be contour/bin/or hex plot not scatter plot. second plot should be filter step, then showuse violin, box, or ridge plot showing one box per year